# Introduction

This repository creates the search index in [Azure AI Search](https://learn.microsoft.com/en-us/azure/search/search-what-is-azure-search) for Tutor.ia

## Project Structure

This section provides an overview of the directory structure for the Tutor.ia project.

```
    ðŸ“¦ aisrch/
    â”œâ”€â”€ ðŸ“‚ src/
    â”‚    â”œâ”€â”€ ðŸ“‚ clients/
    â”‚    â”œâ”€â”€ ðŸ“‚ config/
    â”‚    â”œâ”€â”€ ðŸ“‚ models/
    â”‚    â”œâ”€â”€ ðŸ“‚ services/
    â”‚    â””â”€â”€ ðŸ“„ main.py
    â”œâ”€â”€ ðŸ“„ .env.template
    â”œâ”€â”€ ðŸ“„ poetry.lock
    â”œâ”€â”€ ðŸ“„ pyproject.toml
    â””â”€â”€ ðŸ“„ README.md
```

- **src/**: Source code directory.
    - **clients/**: This subdirectory contains the clients that be used in Azure AI Search.
    - **config/**: This subdirectory contains the settings of the module, accessing the environment variables (config.py).
    - **models/**: This subdirectory contains the models to create the Azure AI Search assets using the Azure AI Search SDK.
    - **services/**: This subdirectory contains the code to create and update the Azure AI Search asset.
    - **main.py**: The entry point of the application. It sets up logging and calls functions to create or update the search index, data source, skillset, and indexer.
- **.env.template**: A template file for environment variables. This file can be copied to create the `.env` file, see the [environment variables section](#set-the-environment-variables) for details.
- **poetry.lock**: A lock file generated by Poetry, a dependency management tool for Python. It ensures that the same dependencies are installed across different environments.
- **pyproject.toml**: Configuration file for Poetry and other build tools. It specifies project metadata, dependencies, scripts, and other settings necessary for building and managing the project.
- **README.md**: Project documentation.

## Set the environment variables

Environment variables are key-value pairs that are accessible to any program running within the environment in which they are set. These variables often contain sensitive information such as API keys, database credentials, or configuration settings. To set them up, just copy the `.env.template` file and make a new file called `.env`. Then, fill in the blanks with the appropiate info, each variable is explained in the below table:

| **Parameter**                               | **Description**                                                                                            |
|---------------------------------------------|------------------------------------------------------------------------------------------------------------|
| AZURE_SEARCH_ENDPOINT                       | Endpoint URL for the Azure Search service instance.                                                        |
| AZURE_SEARCH_ADMIN_KEY                      | Admin API key used to authenticate and authorize requests to the Azure Search service.                     |
| AZURE_SEARCH_INDEX_NAME                     | Name of the Azure Search index to be used.                                                                 |
| AZURE_SEARCH_INDEXER_NAME                   | Name of the Azure Search indexer to be used.                                                               |
| AZURE_SEARCH_SKILLSET_NAME                  | Name of the Azure Search skillset to be used.                                                              |
| AZURE_SEARCH_DATASOURCE_NAME                | Name of the Azure Search datasource to be used.                                                            |
| AZURE_STORAGE_CONNECTION_STRING             | Connection string for accessing the Azure Storage account.                                                 |
| AZURE_STORAGE_CONTAINER_NAME                | Name of the Azure Storage container where the data resides.                                                |
| AZURE_COGNITIVE_SERVICES_KEY                | API key for accessing Azure Cognitive Services.                                                            |
| OPENAI_RESOURCE_URI                         | Base URL for the Azure OpenAI service instance.                                                            |
| OPENAI_API_KEY                              | API key used to authenticate requests to the Azure OpenAI service.                                          |
| OPENAI_EMBEDDINGS_DEPLOYMENT_ID             | Deployment ID for the OpenAI embeddings model.                                                             |
| OPENAI_EMBEDDINGS_MODEL_NAME                | Name of the OpenAI embeddings model to be used.                                                            |


## Create assets in Azure Search

Create an Azure Search index given the schemas defined in `src/models` by running the following command:
```bash
poetry run main.py
```